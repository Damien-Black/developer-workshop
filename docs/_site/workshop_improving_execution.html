<!DOCTYPE html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="keywords" content=" getting_started">
<title>Improving Execution | DNAnexus Developer Workshop</title>
<link rel="stylesheet" href="css/syntax.css">


<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">-->
<link rel="stylesheet" href="css/modern-business.css">
<link rel="stylesheet" href="css/lavish-bootstrap.css">
<link rel="stylesheet" href="css/customstyles.css">
<link rel="stylesheet" href="css/theme-blue.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="js/jquery.navgoco.min.js"></script>


<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/2.0.0/anchor.min.js"></script>
<script src="js/toc.js"></script>
<script src="js/customscripts.js"></script>

<link rel="shortcut icon" href="images/favicon.ico">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link rel="alternate" type="application/rss+xml" title="" href="http://www.dnanexus.comfeed.xml">

    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: true,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

        });

    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    

</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="fa fa-lg navbar-brand" href="index.html">&nbsp;<span class="projectTitle"> DNAnexus Connect Developer Workshop</span></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- entries without drop-downs appear here -->
                
                
                
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">DNAnexus Resources<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        
                        <li><a href="https://platform.dnanexus.com" target="_blank">DNAnexus Platform</a></li>
                        
                        
                        
                        <li><a href="https://wiki.dnanexus.com" target="_blank">DNAnexus Wiki</a></li>
                        
                        
                    </ul>
                </li>
                
                
                
                <!--comment out this block if you want to hide search-->
                <li>
                    <!--start search-->
                    <div id="search-demo-container">
                        <input type="text" id="search-input" placeholder="search...">
                        <ul id="results-container"></ul>
                    </div>
                    <script src="js/jekyll-search.js" type="text/javascript"></script>
                    <script type="text/javascript">
                            SimpleJekyllSearch.init({
                                searchInput: document.getElementById('search-input'),
                                resultsContainer: document.getElementById('results-container'),
                                dataSource: 'search.json',
                                searchResultTemplate: '<li><a href="{url}" title="Improving Execution">{title}</a></li>',
                    noResultsText: 'No results found.',
                            limit: 10,
                            fuzzy: true,
                    })
                    </script>
                    <!--end search-->
                </li>
            </ul>
        </div>
        </div>
        <!-- /.container -->
</nav>

<!-- Page Content -->
<div class="container">
    <div class="col-lg-12">&nbsp;</div>
    <!-- Content Row -->
    <div class="row">
        <!-- Sidebar Column -->
        <div class="col-md-3">

          


<ul id="mysidebar" class="nav">
    <li class="sidebarTitle">Developer Workshop </li>
    
    
    
    <li>
        <a href="#">Workshop Topics</a>
        <ul>
            
            
            
            <li><a href="index.html">0. Welcome</a></li>
            
            
            
            
            
            
            <li><a href="workshop_getting_started.html">1. Getting Started</a></li>
            
            
            
            
            
            
            <li><a href="workshop_organizing_the_pipeline.html">2. Organizing the Pipeline</a></li>
            
            
            
            
            
            
            <li><a href="workshop_do_you_need_an_applet.html">3. Do You Need an Applet?</a></li>
            
            
            
            
            
            
            <li><a href="workshop_basic_applet_structure.html">4. Basic Applet Structure</a></li>
            
            
            
            
            
            
            <li><a href="workshop_debugging_and_error_handling.html">5. Debugging and Error Handling</a></li>
            
            
            
            
            
            
            <li class="active"><a href="workshop_improving_execution.html">6. Improving Execution</a></li>
            
            
            
            
            
            
            <li><a href="workshop_improving_file_io.html">7. Improving File IO</a></li>
            
            
            
            
            
            
            <li><a href="workshop_parallelization.html">8. Parallelization</a></li>
            
            
            
            
            
            
            <li><a href="workshop_distributed_applets.html">9. Distributed Applets</a></li>
            
            
            
            
            
            
            <li><a href="workshop_handling_complex_dependencies.html">10. Handling Complex Dependencies</a></li>
            
            
            
            
        </ul>
        
        
        
        <!-- if you aren't using the accordion, uncomment this block:
           <p class="external">
               <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
           </p>
           -->
    </li>
</ul>
</div>

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>

    <!-- Content Column -->
    <div class="col-md-9">
        <div class="post-header">
   <h1 class="post-title-main">Improving Execution</h1>
</div>



<div class="post-content">

   

    
    
<!-- this handles the automatic toc. use ## for subheads to auto-generate the on-page minitoc. if you use html tags, you must supply an ID for the heading element in order for it to appear in the minitoc. -->
<script>
$( document ).ready(function() {
  // Handler for .ready() called.

$('#toc').toc({ minimumHeaders: 0, listType: 'ul', showSpeed: 0, headers: 'h2,h3,h4' });

/* this offset helps account for the space taken up by the floating toolbar. */
$('#toc').on('click', 'a', function() {
  var target = $(this.getAttribute('href'))
    , scroll_target = target.offset().top

  $(window).scrollTop(scroll_target - 10);
  return false
})
  
});
</script>

<div id="toc"></div>

    

    

    

    

  <p>There are a number of ways to configure applets to run beyond the defaults used by the
platform.</p>

<h2 id="instance-type">6.0 Instance Type</h2>

<p>If you do not specify an instance type for your applet, it will default to an instance
called “mem2_hdd2_x2”. The user can override this, but it is better to specify a better
default value so the user does not have to worry about it.</p>

<p>This is done in the dxapp.json file:</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="w">  </span><span class="err">...</span><span class="w">
  </span><span class="s2">"runSpec"</span><span class="err">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="err">...</span><span class="w">
    </span><span class="nt">"systemRequirements"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">"*"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">"instanceType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"mem1_ssd1_x8"</span><span class="p">}},</span><span class="w">
  </span><span class="err">}</span><span class="w">
  </span><span class="err">...</span><span class="w">
</span></code></pre>
</div>

<p>The list of DNAnexus instance types and the resources available for each one is available on
the DNAnexus <a href="https://wiki.dnanexus.com/API-Specification-v1.0.0/Instance-Types">wiki</a>.</p>

<h3 id="selecting-an-instance-type">Selecting an instance type</h3>

<p>Choosing the best default value for instance type is a bit of an art. There are a few
things to keep in mind:</p>

<ul>
  <li><strong>Memory requirements</strong>. You need to make sure that the worker has enough
memory to accomodate the applet’s highest memory usage.</li>
  <li><strong>Local storage requirements</strong>. You have to make sure that there is enough
disk space on the worker to fit input and output files for the applet.</li>
  <li><strong>Parallelization of multiple cores</strong>. Generally, you would like to have your
jobs finish faster, and you can often do that by increasing the number of
CPUs that your applet uses. However, the improvement is not always linear.
A program may only run, say, 20% faster if we double the number of CPUs.</li>
  <li><strong>Cost</strong>. The cost of an instance increases with CPUs, memory, and storage.
We want to avoid paying for resources that we are not going to use.</li>
</ul>

<h2 id="selecting-an-os-release">6.1 Selecting an OS Release</h2>

<p>The default operating system use by DNAnexus workers is Ubuntu 12.04. However, Ubuntu 12.04
will reach end-of-life in April 2017, which is rather soon. This means that it will stop
receiving security updates and more generally will be increasingly out of date.</p>

<p>Ubuntu 12.04 will remain the default, but you can specify Ubuntu 14.04 in the dxapp.json file:</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="w">  </span><span class="err">...</span><span class="w">
  </span><span class="s2">"runSpec"</span><span class="err">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="err">...</span><span class="w">
    </span><span class="nt">"distribution"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Ubuntu"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"release"</span><span class="p">:</span><span class="w"> </span><span class="s2">"14.04"</span><span class="p">,</span><span class="w">
  </span><span class="err">}</span><span class="w">
  </span><span class="err">...</span><span class="w">
</span></code></pre>
</div>

<p>One caveat to using Ubuntu 14.04 is that not all instance typs on DNAnexus currently support it.
Specifically, any instance type with “hdd2” in its name will not work with Ubuntu 14.04.</p>

<p>But, unless you need one of those instance types, it is almost always better to switch to Ubuntu 14.04.</p>

<h2 id="setting-a-timeout-policy">6.2 Setting a Timeout Policy</h2>

<p>Sometimes an applet can enter a state where productive work has stopped, but there has been
no error and the script is not complete. For example, an executable can just hang rather than
fail. In that case, the applet will just keep running for 30 days or until you notice it and
terminate it. That can lead to an unexpectedly high cost for a failed job.</p>

<p>You can protect yourself against this by using a “timeoutPolicy” in the applet’s dxapp.json:</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="w">  </span><span class="err">...</span><span class="w">
  </span><span class="s2">"runSpec"</span><span class="err">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="err">...</span><span class="w">
    </span><span class="nt">"timeoutPolicy"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">"*"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">"hours"</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="nt">"minutes"</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="p">}}</span><span class="w">
  </span><span class="p">}</span><span class="w">
  </span><span class="err">...</span><span class="w">
</span></code></pre>
</div>

<p>Choose an timeout value that is longer than you reasonably expect the applet to run on a large input.</p>

<h2 id="versioning">6.3 Versioning</h2>

<p>Finally, you can indicate a version of your applet in the dxapp.json file. This has more of an impact
when you switch from applets to apps, but it is still a nice thing to keep track of in an applet:</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"hisat2"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.0.1"</span><span class="p">,</span><span class="w">
  </span><span class="err">...</span><span class="w">
</span></code></pre>
</div>


    <div class="tags">
        
    </div>

    

</div>

<hr class="shaded"/>

<footer>
            <div class="row">
                <div class="col-lg-12 footer">
               &copy;2016 DNAnexus. All rights reserved. <br />
 Site last generated: Oct 5, 2016 <br />
<p><img src="images/company_logo.png" alt="Company logo"/></p>
                </div>
            </div>
</footer>


    </div>
    <!-- /.row -->
</div>
<!-- /.container -->
    </div>

</body>

</html>